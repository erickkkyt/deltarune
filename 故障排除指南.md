# Deltarune é¡¹ç›®æ•…éšœæ’é™¤æŒ‡å—

## ğŸš¨ å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

### 1. EPERM æƒé™é”™è¯¯å’Œä¸­é—´ä»¶é…ç½®é”™è¯¯

#### é”™è¯¯è¡¨ç°
```
[Error: EPERM: operation not permitted, open 'D:\...\deltarune\.next\trace']
â¨¯ Error: The Middleware "/src/middleware" must export a 'middleware' or a 'default' function
```

#### ğŸ” åŸå› åˆ†æ
- **å¤šè¿›ç¨‹å†²çª**: å¤šä¸ª Node.js è¿›ç¨‹åŒæ—¶è¿è¡Œ
- **æ–‡ä»¶é”å®š**: `.next` ç›®å½•è¢«å ç”¨
- **Windows æƒé™é—®é¢˜**: æ–‡ä»¶ç³»ç»Ÿæƒé™é™åˆ¶
- **ä¸­é—´ä»¶é…ç½®é”™è¯¯**: `src/middleware.ts` æ–‡ä»¶ä¸ºç©ºæˆ–ç¼ºå°‘å¿…éœ€çš„å¯¼å‡ºå‡½æ•°

#### âš¡ å¿«é€Ÿè§£å†³
```bash
# æ–¹æ³•1: ä½¿ç”¨æ¸…ç†è„šæœ¬ (æ¨è)
npm run cleanup
npm run dev

# æ–¹æ³•2: æ‰‹åŠ¨æ¸…ç†
npm run fresh-start
```

#### ğŸ› ï¸ æ‰‹åŠ¨è§£å†³æ­¥éª¤
1. **åœæ­¢æ‰€æœ‰è¿›ç¨‹**
   ```powershell
   taskkill /f /im node.exe
   ```

2. **æ¸…ç†æ„å»ºç¼“å­˜**
   ```powershell
   Remove-Item -Recurse -Force .next
   ```

3. **ä¿®å¤ä¸­é—´ä»¶**
   - ç¡®ä¿ `src/middleware.ts` æ­£ç¡®å¯¼å‡ºä¸­é—´ä»¶å‡½æ•°

4. **é‡æ–°å¯åŠ¨**
   ```bash
   npm run dev
   ```

### 2. ç«¯å£å ç”¨é”™è¯¯

#### é”™è¯¯è¡¨ç°
```
Error: listen EADDRINUSE: address already in use :::3000
```

#### è§£å†³æ–¹æ¡ˆ
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :3000

# åœæ­¢è¿›ç¨‹ (æ›¿æ¢ PID)
taskkill /f /pid <PID>

# æˆ–è€…ä½¿ç”¨ä¸åŒç«¯å£
npm run dev -- -p 3001
```

### 3. å¤šè¯­è¨€é…ç½®é”™è¯¯

#### é”™è¯¯è¡¨ç°
```
Module not found: Can't resolve '@/i18n/navigation'
```

#### è§£å†³æ–¹æ¡ˆ
1. **æ£€æŸ¥å¤šè¯­è¨€å¼€å…³**
   ```typescript
   // src/config/site.ts
   i18n: {
     enabled: 1,  // ç¡®ä¿å·²å¯ç”¨
   }
   ```

2. **éªŒè¯æ–‡ä»¶ç»“æ„**
   ```bash
   # æ£€æŸ¥å¿…è¦æ–‡ä»¶
   src/i18n/routing.ts
   src/i18n/request.ts
   middleware.ts
   ```

3. **é‡æ–°æ„å»º**
   ```bash
   npm run cleanup
   npm run build
   ```

### 4. TypeScript ç±»å‹é”™è¯¯

#### é”™è¯¯è¡¨ç°
```
Type error: Cannot find module '@/i18n/navigation'
```

#### è§£å†³æ–¹æ¡ˆ
1. **é‡å¯ TypeScript æœåŠ¡å™¨**
   - VS Code: `Ctrl+Shift+P` â†’ "TypeScript: Restart TS Server"

2. **æ£€æŸ¥ tsconfig.json è·¯å¾„æ˜ å°„**
   ```json
   {
     "compilerOptions": {
       "paths": {
         "@/*": ["./src/*"]
       }
     }
   }
   ```

### 5. ç¿»è¯‘æ–‡ä»¶é”™è¯¯

#### é”™è¯¯è¡¨ç°
```
Error: Cannot find message for key 'home.hero.title'
```

#### è§£å†³æ–¹æ¡ˆ
1. **éªŒè¯ç¿»è¯‘æ–‡ä»¶**
   ```bash
   # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   messages/en/home.json
   messages/zh/home.json
   ```

2. **éªŒè¯ JSON æ ¼å¼**
   ```json
   {
     "hero": {
       "title": "Deltarune Online"
     }
   }
   ```

3. **æ£€æŸ¥å¯¼å…¥é…ç½®**
   ```typescript
   // src/i18n/request.ts
   messages: {
     home: (await import(`../../messages/${locale}/home.json`)).default
   }
   ```

## ğŸ› ï¸ å¼€å‘å·¥å…·

### æ¸…ç†è„šæœ¬
```bash
# å®Œæ•´æ¸…ç†å¹¶é‡å¯
npm run fresh-start

# ä»…æ¸…ç†ç¼“å­˜
npm run cleanup
```

### è¯Šæ–­å‘½ä»¤
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :3000

# æŸ¥çœ‹ Node.js è¿›ç¨‹
tasklist | findstr node.exe

# æ£€æŸ¥é¡¹ç›®çŠ¶æ€
npm run type-check
```

### æ—¥å¿—è°ƒè¯•
```bash
# è¯¦ç»†å¯åŠ¨æ—¥å¿—
npm run dev -- --turbo

# æ„å»ºåˆ†æ
npm run build -- --debug
```

## ğŸ”§ é¢„é˜²æªæ–½

### 1. å¼€å‘ç¯å¢ƒé…ç½®
- ä½¿ç”¨ PowerShell ä½œä¸ºé»˜è®¤ç»ˆç«¯
- ç¡®ä¿ç®¡ç†å‘˜æƒé™ï¼ˆå¿…è¦æ—¶ï¼‰
- å®šæœŸæ¸…ç†é¡¹ç›®ç¼“å­˜

### 2. ä»£ç è´¨é‡æ£€æŸ¥
```bash
# è¿è¡Œæ£€æŸ¥
npm run lint
npm run type-check
```

### 3. ä¾èµ–ç®¡ç†
```bash
# å®šæœŸæ›´æ–°ä¾èµ–
npm update

# æ£€æŸ¥æ¼æ´
npm audit
```

## ğŸ“‹ å¿«é€Ÿè¯Šæ–­æ¸…å•

å½“é‡åˆ°é—®é¢˜æ—¶ï¼Œè¯·æŒ‰é¡ºåºæ£€æŸ¥ï¼š

- [ ] åœæ­¢æ‰€æœ‰å¼€å‘æœåŠ¡å™¨
- [ ] è¿è¡Œ `npm run cleanup`
- [ ] æ£€æŸ¥ Node.js ç‰ˆæœ¬å…¼å®¹æ€§
- [ ] éªŒè¯å¤šè¯­è¨€é…ç½®å¼€å…³
- [ ] æ£€æŸ¥æ–‡ä»¶æƒé™
- [ ] é‡æ–°å®‰è£…ä¾èµ– (`rm -rf node_modules && npm install`)
- [ ] é‡å¯ IDE/ç¼–è¾‘å™¨

## ğŸ†˜ è·å–å¸®åŠ©

### å¸¸ç”¨æ£€æŸ¥å‘½ä»¤
```bash
# é¡¹ç›®çŠ¶æ€
node --version
npm --version

# ç«¯å£æ£€æŸ¥
netstat -ano | findstr :3000

# æƒé™æµ‹è¯•
npm run cleanup
```

### é‡ç½®é¡¹ç›®çŠ¶æ€
```bash
# å®Œå…¨é‡ç½® (æ…ç”¨)
npm run cleanup
rm -rf node_modules
npm install
npm run dev
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸæ¸…ç†**: æ¯å¤©å¼€å‘ç»“æŸåè¿è¡Œ `npm run cleanup`
2. **å•ä¸€è¿›ç¨‹**: é¿å…åŒæ—¶è¿è¡Œå¤šä¸ªå¼€å‘æœåŠ¡å™¨
3. **æƒé™ç®¡ç†**: ç¡®ä¿é¡¹ç›®ç›®å½•æœ‰é€‚å½“çš„è¯»å†™æƒé™
4. **ç‰ˆæœ¬æ§åˆ¶**: ä¸è¦æäº¤ `.next` ç›®å½•åˆ° Git
5. **ç¯å¢ƒéš”ç¦»**: ä½¿ç”¨ä¸åŒç«¯å£è¿è¡Œä¸åŒé¡¹ç›®

è®°ä½ï¼šå¤§å¤šæ•°é—®é¢˜éƒ½å¯ä»¥é€šè¿‡æ¸…ç†ç¼“å­˜å’Œé‡å¯è§£å†³ï¼ ğŸ¯ 